StartRec(MZHEADER)
	ah(char, Signature, 2)
	f(WORD, PartPag)
    f(WORD, Page_count)
    f(WORD, Relo_count)
    f(WORD, Header_size)
    f(WORD, Minimum_memory)
    f(WORD, Maximum_memory)
	f(WORD, ReloSS)
    f(WORD, ExeSP)
    f(WORD, Check_sum)
    f(WORD, ExeIP)
    f(WORD, ReloCS)
    f(WORD, Table_offset)
    f(WORD, Overlay)
    r(Reserved, 32)
	f(DWORD, PE_offset)
EndRec(MZHEADER)

StartRec(PEHEADER)
    ah(char, Signature, 4)
    f(WORD, CPU_type)
    f(WORD, Number_of_objects)
    f(DWORD, Date_time)
    r(Reserved1, 8)
    f(WORD, NT_length)
    f(WORD, Flags)
    r(Reserved2, 2)
    f(WORD, Linker_version)
    r(Reserved3, 12)
    p(Entrypoint_RVA)
    r(Reserved4, 8)
    f(DWORD, Image_base)
    f(DWORD, Object_align)
    f(DWORD, File_align)
    f(DWORD, OS_version)
    f(DWORD, User_version)
    f(DWORD, NT_version)
    r(Reserved5, 4)
    f(DWORD, Program_size)
    f(DWORD, Full_title_size)
    f(DWORD, Check_sum)
    f(WORD, NT_sub_system)
    f(WORD, DLL_flags)
    f(DWORD, Stack_size)
    f(DWORD, Minimal_stack_size)
    f(DWORD, Heap_size)
    f(DWORD, Minimal_heap_size)
    r(Reserved6, 4)
    f(DWORD, Array_size)
    p(Export_table_offset)
    f(DWORD, Export_table_size)
    p(Import_table_offset)
    f(DWORD, Import_table_size)
    p(Resource_table_offset)
    f(DWORD, Resource_table_size)
    f(DWORD, Exception_table_offset)
    f(DWORD, Exception_table_size)
    f(DWORD, WarrTabOffset)
    f(DWORD, WarrTabSize)
    p(AddrTabOffset)
    f(DWORD, AddrTabSize)
    p(Debug_table_offset)
    f(DWORD, Debug_table_size)
    f(DWORD, DescrTabOffset)
    f(DWORD, DescrTabSize)
    f(DWORD, MachSpecOffset)
    f(DWORD, MachSpecSize)
    f(DWORD, TLSOffset)
    f(DWORD, TLSSize)
    f(DWORD, LoadCFGOffset)
    f(DWORD, LoadCFGSize)
    r(Reserved7, 8)
    f(DWORD, IATOffset)
    f(DWORD, IATSize)
	r(Reserved8, 24)
EndRec(PEHEADER)

StartRec(OBJECTTABLE)
    a(char, Name, 8)
    f(DWORD, Virtual_size)
    p(RVA)
    f(DWORD, Phisical_size)
    f(DWORD, Offset)
    r(Reserved, 12)
    f(DWORD, Flags)
EndRec(OBJECTTABLE)

StartRec(IMPORTDIRECTORYTABLE)
    p(Lookup_offset)
    f(DWORD, Time_date_stamp)
    f(DWORD, Forward_chain)
    p(Library_name_offset)
    p(Address_table_offset)
EndRec(IMPORTDIRECTORYTABLE)

StartRec(EXPORTDIRECTORYTABLE)
    f(DWORD, Flags)
    f(DWORD, Time_date_stamp)
    f(DWORD, Version)
    p(Name_RVA)
    f(DWORD, Ordinal_base)
    f(DWORD, Number_of_funcs)
    f(DWORD, Number_of_names)
    p(Address_table_offset)
    p(Name_pointers_RVA)
    p(Ordinal_table_RVA)
EndRec(EXPORTDIRECTORYTABLE)

StartRec(EXPORTEDENTRY)
	pcd(char, Name, "Имя")
	fdt(DWORD, Ordinal, "Ординал", DT_UNSIGNED)
	pd(Address, "Адрес входа")
EndRec(EXPORTEDENTRY)

PreDefRec(IMPORTEDLIB)

StartRec(IMPORTEDENTRY)
	pcd(char, Name, "Имя")
	fdt(DWORD, Ordinal, "Ординал", DT_UNSIGNED)
	pd(Address, "Адрес связи")
	psd(IMPORTEDLIB, Library, "Библиотека")
EndRec(IMPORTEDENTRY)

StartRec(IMPORTEDLIB)
	pcd(char, Name, "Библиотека")
	psc(IMPORTEDENTRY, Entries)
EndRec(IMPORTEDLIB)